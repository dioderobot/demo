# 3 A step-down switching regulator 

Datasheet - production data
![img-0.jpeg](img-0.jpeg)

## Features

- 3 A DC output current
- 4.5 V to 38 V input voltage
- Output voltage adjustable from 0.6 V
- 250 kHz switching frequency, programmable up to 1 MHz
- Internal soft-start and enable
- Low dropout operation: 100\% duty cycle
- Voltage feed-forward
- Zero load current operation
- Overcurrent and thermal protection
- VFDFPN $3 \times 3$ - 10L and HSOP8 package


## Applications

- Consumer: STB, DVD, DVD recorder, car audio, LCD TV and monitors
- Industrial: PLD, PLA, FPGA, chargers
- Networking: XDSL, modems, DC-DC modules
- Computer: optical storage, hard disk drive, printers, audio/graphic cards
- LED driving


## Description

The L7986/A is a step-down switching regulator with a 3.7 A (minimum) current limited embedded power MOSFET, so it is able to deliver up to 3 A current to the load depending on the application conditions. The input voltage can range from 4.5 V to 38 V , while the output voltage can be set starting from 0.6 V to $\mathrm{V}_{\mathrm{IN}}$. Requiring a minimum set of external components, the device includes an internal 250 kHz switching frequency oscillator that can be externally adjusted up to 1 MHz . The DFN and the HSOP packages with exposed pad allow reducing the $R_{\text {thJA }}$ down to $60^{\circ} \mathrm{C} / \mathrm{W}$ and 40 ${ }^{\circ} \mathrm{C} / \mathrm{W}$ respectively.

Figure 1. Application circuit
![img-1.jpeg](img-1.jpeg)# Contents 

1 Pin settings ..... 6
1.1 Pin connection ..... 6
1.2 Pin description ..... 6
2 Maximum ratings ..... 7
3 Thermal data ..... 7
4 Electrical characteristics ..... 8
5 Functional description ..... 10
5.1 Oscillator and synchronization ..... 11
5.2 Soft-start ..... 13
5.3 Error amplifier and compensation ..... 14
5.4 Overcurrent protection ..... 14
5.5 Enable function ..... 16
5.6 Hysteretic thermal shutdown ..... 16
6 Application information ..... 17
6.1 Input capacitor selection ..... 17
6.2 Inductor selection ..... 18
6.3 Output capacitor selection ..... 19
6.4 Compensation network ..... 20
6.4.1 Type III compensation network ..... 22
6.4.2 Type II compensation network ..... 26
6.5 Thermal considerations ..... 29
6.6 Layout considerations ..... 30
6.7 Application circuit ..... 32
7 Application ideas ..... 36
7.1 Positive buck-boost ..... 36
7.2 Inverting buck-boost ..... 388 Package information ..... 40
8.1 VFDFPN10 ( $3 \times 3 \times 1.0 \mathrm{~mm}$ ) package information ..... 41
8.2 HSOP8 package information ..... 43
9 Ordering information ..... 45
10 Revision history ..... 46# List of tables 

Table 1. Pin description ..... 5
Table 2. Absolute maximum ratings ..... 6
Table 3. Thermal data ..... 6
Table 4. Electrical characteristics ..... 7
Table 5. Uncompensated error amplifier characteristics. ..... 13
Table 6. Input MLCC capacitors ..... 17
Table 7. Inductors ..... 18
Table 8. Output capacitors ..... 19
Table 9. Component list ..... 31
Table 10. VFDFPN10 ( $3 \times 3 \times 1.0 \mathrm{~mm}$ ) package mechanical data ..... 41
Table 11. HSOP8 package mechanical data ..... 43
Table 12. Order code ..... 44
Table 13. Document revision history ..... 45# List of figures 

Figure 1. Application circuit ..... 1
Figure 2. Pin connection (top view) ..... 6
Figure 3. Block diagram ..... 10
Figure 4. Oscillator circuit block diagram ..... 11
Figure 5. Sawtooth: voltage and frequency feed-forward; external synchronization ..... 12
Figure 6. Oscillator frequency vs. FSW pin resistor ..... 12
Figure 7. Soft-start scheme ..... 13
Figure 8. Overcurrent protection ..... 16
Figure 9. The error amplifier, the PWM modulator, and the LC output filter ..... 21
Figure 10. Type III compensation network ..... 22
Figure 11. Open-loop gain: module Bode diagram ..... 23
Figure 12. Open-loop gain Bode diagram with ceramic output capacitor ..... 25
Figure 13. Type II compensation network ..... 26
Figure 14. Open-loop gain: module Bode diagram ..... 27
Figure 15. Open-loop gain Bode diagram with electrolytic/tantalum output capacitor ..... 28
Figure 16. Switching losses ..... 30
Figure 17. Layout example ..... 31
Figure 18. Demonstration board application circuit ..... 32
Figure 19. PCB layout: L7986 and L7986A (component side) ..... 33
Figure 20. PCB layout: L7986 and L7986A (bottom side) ..... 33
Figure 21. PCB layout: L7986 and L7986A (front side) ..... 33
Figure 22. Junction temperature vs. output current VIN $=24 \mathrm{~V}$ ..... 34
Figure 23. Junction temperature vs. output current VIN $=12 \mathrm{~V}$ ..... 34
Figure 24. Junction temperature vs. output current VIN $=5 \mathrm{~V}$ ..... 34
Figure 25. Efficiency vs. output current VO $=1.8 \mathrm{~V}$ ..... 34
Figure 26. Efficiency vs.output current $\mathrm{VO}=5.0 \mathrm{~V}$ ..... 34
Figure 27. Efficiency vs.output current $\mathrm{VO}=3.3 \mathrm{~V}$ ..... 34
Figure 28. Load regulation ..... 35
Figure 29. Line regulation ..... 35
Figure 30. Load transient: from 0.4 A to 2 A ..... 35
Figure 31. Soft-start ..... 35
Figure 32. Short-circuit behavior VIN $=12 \mathrm{~V}$ ..... 35
Figure 33. Short-circuit behavior VIN $=24 \mathrm{~V}$ ..... 35
Figure 34. Positive buck-boost regulator ..... 36
Figure 35. Maximum output current according to max DC switch current (3.0 A): VO $=12 \mathrm{~V}$ ..... 37
Figure 36. Inverting buck-boost regulator ..... 38
Figure 37. Maximum output current according to switch max. peak current (3.0 A): VO $=-5 \mathrm{~V}$ ..... 39
Figure 38. VFDFPN10 ( $3 \times 3 \times 1.0 \mathrm{~mm}$ ) package outline ..... 41
Figure 39. HSOP8 package outline ..... 43# 1 Pin settings 

### 1.1 Pin connection

Figure 2. Pin connection (top view)
![img-2.jpeg](img-2.jpeg)

### 1.2 Pin description

Table 1. Pin description

| No. <br> (VFDFPN) | No. <br> (HSOP) | Type | Description |
| :--: | :--: | :--: | :-- |
| $1-2$ | 1 | OUT | Regulator output |
| 3 | 2 | SYNCH | Master/slave synchronization. When it is left floating, a signal with a phase shift of half a period, with respect to the power turn-on is present at the pin. When connected to an external signal at a frequency higher than the internal one, the device is synchronized by the external signal, with zero phase shift. <br> Connecting together the SYNCH pin of two devices, the one with a higher frequency works as master and the other one as slave; so the two powers turn-ons have a phase shift of half a period. |
| 4 | 3 | EN | A logical signal (active high) enables the device. With EN higher than 1.2 V the device is ON and with EN lower than 0.3 V the device is OFF. |
| 5 | 4 | COMP | Error amplifier output to be used for loop frequency compensation. |
| 6 | 5 | FB | Feedback input. By connecting the output voltage directly to this pin the output voltage is regulated at 0.6 V . To have higher regulated voltages an external resistor divider is required from Vout to the FB pin. |
| 7 | 6 | $\mathrm{F}_{\text {SW }}$ | The switching frequency can be increased connecting an external resistor from the FSW pin and ground. If this pin is left floating, the device works at its free-running frequency of 250 kHz . |
| 8 | 7 | GND | Ground |
| $9-10$ | 8 | $\mathrm{V}_{\mathrm{CC}}$ | Unregulated DC input voltage. |# 2 Maximum ratings 

Table 2. Absolute maximum ratings

| Symbol | Parameter |  | Value | Unit |
| :--: | :--: | :--: | :--: | :--: |
| Vcc | Input voltage |  | 45 | V |
| OUT | Output DC voltage |  | $-0.3$ to $\mathrm{V}_{\mathrm{CC}}$ |  |
| $\mathrm{F}_{\text {SW }}$, COMP, SYNCH | Analog pin |  | $-0.3$ to 4 |  |
| EN | Enable pin |  | $-0.3$ to $\mathrm{V}_{\mathrm{CC}}$ |  |
| FB | Feedback voltage |  | $-0.3$ to 1.5 |  |
| $\mathrm{P}_{\text {TOT }}$ | Power dissipation at $\mathrm{T}_{\mathrm{A}}<60^{\circ} \mathrm{C}$ | VFDFPN | 1.5 | W |
|  |  | HSOP | 2 |  |
| $\mathrm{T}_{\mathrm{J}}$ | Junction temperature range |  | -40 to 150 | ${ }^{\circ} \mathrm{C}$ |
| $\mathrm{T}_{\text {stg }}$ | Storage temperature range |  | -55 to 150 | ${ }^{\circ} \mathrm{C}$ |

## 3 Thermal data

Table 3. Thermal data

| Symbol | Parameter |  | Value | Unit |
| :--: | :--: | :--: | :--: | :--: |
| $\mathrm{R}_{\mathrm{INJ}}$ | Maximum thermal resistance junction ambient ${ }^{(1)}$ | VFDFPN | 60 | ${ }^{\circ} \mathrm{C} / \mathrm{W}$ |
|  |  | HSOP | 40 |  |

1. Package mounted on demonstration board.# 4 Electrical characteristics 

$T_{J}=25^{\circ} \mathrm{C}, \mathrm{V}_{\mathrm{CC}}=12 \mathrm{~V}$, unless otherwise specified.
Table 4. Electrical characteristics

| Symbol | Parameter | Test condition | Values |  |  | Unit |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: |
|  |  |  | Min. | Typ. | Max. |  |
| $V_{C C}$ | Operating input voltage range | ${ }^{(1)}$ | 4.5 |  | 38 | V |
| $\mathrm{V}_{\text {CCON }}$ | Turn-on $\mathrm{V}_{\mathrm{CC}}$ threshold | ${ }^{(1)}$ |  |  | 4.5 |  |
| $\mathrm{V}_{\text {CCHYS }}$ | $\mathrm{V}_{\mathrm{CC}}$ UVLO hysteseris | ${ }^{(1)}$ | 0.1 |  | 0.4 |  |
| $R_{\text {DSON }}$ | MOSFET on resistance |  |  | 200 |  | $\mathrm{m} \Omega$ |
|  |  | ${ }^{(1)}$ |  |  | 400 |  |
| $I_{L I M}$ | Maximum limiting current |  | 3.7 | 4.2 | 4.7 | A |
| Oscillator |  |  |  |  |  |  |
| $\mathrm{F}_{\text {SW }}$ | Switching frequency | ${ }^{(1)}$ | 210 | 250 | 275 | kHz |
| $\mathrm{V}_{\text {FSW }}$ | FSW pin voltage |  |  | 1.254 |  | V |
| D | Duty cycle |  | 0 |  | 100 | $\%$ |
| $\mathrm{F}_{\text {ADJ }}$ | Adjustable switching frequency | $R_{\text {FSW }}=33 \mathrm{k} \Omega$ |  | 1000 |  | kHz |
| Dynamic characteristics |  |  |  |  |  |  |
| $\mathrm{V}_{\mathrm{FB}}$ | Feedback voltage | $4.5 \mathrm{~V}<\mathrm{V}_{\mathrm{CC}}<38 \mathrm{~V}$ | 0.593 | 0.6 | 0.607 | V |
|  |  | $4.5 \mathrm{~V}<\mathrm{V}_{\mathrm{CC}}<38 \mathrm{~V}^{(1)}$ | 0.582 | 0.6 | 0.618 |  |
| DC characteristics |  |  |  |  |  |  |
| $I_{Q}$ | Quiescent current | Duty cycle $=0, \mathrm{~V}_{\mathrm{FB}}=0.8 \mathrm{~V}$ |  |  | 2.4 | mA |
| $\mathrm{I}_{\text {QST-BY }}$ | Total standby quiescent current |  |  | 20 | 30 | $\mu \mathrm{A}$ |
| Enable |  |  |  |  |  |  |
| $\mathrm{V}_{\mathrm{EN}}$ | EN threshold voltage | Device OFF level |  |  | 0.3 | V |
|  |  | Device ON level | 1.2 |  |  |  |
| $I_{E N}$ | EN current | $\mathrm{EN}=\mathrm{V}_{\mathrm{CC}}$ |  | 7.5 | 10 | $\mu \mathrm{A}$ |
| Soft start |  |  |  |  |  |  |
| $T_{S S}$ | Soft-start duration | FSW pin floating | 7.4 | 8.2 | 9.1 | ms |
|  |  | $\mathrm{F}_{\text {SW }}=1 \mathrm{MHz}, \mathrm{R}_{\text {FSW }}=33 \mathrm{k} \Omega$ |  | 2 |  |  |
| Error amplifier |  |  |  |  |  |  |
| $\mathrm{V}_{\mathrm{CH}}$ | High level output voltage | $\mathrm{V}_{\mathrm{FB}}<0.6 \mathrm{~V}$ | 3 |  |  | V |
| $\mathrm{V}_{\mathrm{CL}}$ | Low level output voltage | $\mathrm{V}_{\mathrm{FB}}>0.6 \mathrm{~V}$ |  |  | 0.1 |  |
| $I_{O \text { SOURCE }}$ | Source COMP pin | $\mathrm{V}_{\mathrm{FB}}=0.5 \mathrm{~V}, \mathrm{~V}_{\text {COMP }}=1 \mathrm{~V}$ |  | 19 |  | mA |Table 4. Electrical characteristics (continued)

| Symbol | Parameter | Test condition | Values |  |  | Unit |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: |
|  |  |  | Min. | Typ. | Max. |  |
| $\mathrm{I}_{\mathrm{O} \text { SINK }}$ | Sink COMP pin | $\mathrm{V}_{\mathrm{FB}}=0.7 \mathrm{~V}, \mathrm{~V}_{\text {COMP }}=1 \mathrm{~V}$ |  | 30 |  | mA |
| $G_{V}$ | Open-loop voltage gain | ${ }^{(2)}$ |  | 100 |  | dB |
| Synchronization function |  |  |  |  |  |  |
| $\mathrm{V}_{\mathrm{S} \text { IN,HI }}$ | High input voltage |  | 2 |  | 3.3 | V |
| $\mathrm{V}_{\mathrm{S} \text { IN,LO }}$ | Low input voltage |  |  |  | 1 |  |
| $\mathrm{I}_{\text {S_IN_PW }}$ | Input pulse width | $\mathrm{V}_{\mathrm{S} \text { IN,HI }}=3 \mathrm{~V}, \mathrm{~V}_{\mathrm{S} \text { IN,LO }}=0 \mathrm{~V}$ | 100 |  |  | ns |
|  |  | $\mathrm{V}_{\mathrm{S} \text { IN,HI }}=2 \mathrm{~V}, \mathrm{~V}_{\mathrm{S} \text { IN,LO }}=1 \mathrm{~V}$ | 300 |  |  |  |
| $\mathrm{I}_{\text {SYNCH,LO }}$ | Slave sink current | $\mathrm{V}_{\text {SYNCH }}=2.9 \mathrm{~V}$ |  | 0.7 | 1 | mA |
| $\mathrm{V}_{\text {S_OUT,HI }}$ | Master output amplitude | $\mathrm{I}_{\text {SOURCE }}=4.5 \mathrm{~mA}$ | 2 |  |  | V |
| $\mathrm{I}_{\text {S_OUT_PW }}$ | Output pulse width | SYNCH floating |  | 110 |  | ns |
| Protection |  |  |  |  |  |  |
| $T_{\text {SHDN }}$ | Thermal shutdown |  |  | 150 |  | ${ }^{\circ} \mathrm{C}$ |
|  | Hystereris |  |  | 30 |  |  |

1. Specifications referred to $T_{J}$ from -40 to $+125^{\circ} \mathrm{C}$. Specifications in the -40 to $+125^{\circ} \mathrm{C}$ temperature range are assured by design, characterization and statistical correlation.
2. Guaranteed by design.# 5 Functional description 

The L7986 device is based on a "voltage mode", constant frequency control. The output voltage $\mathrm{V}_{\text {OUT }}$ is sensed by the feedback pin (FB) compared to an internal reference $(0.6 \mathrm{~V})$ providing an error signal that, compared to a fixed frequency sawtooth, controls the on- and off-time of the power switch.

The main internal blocks are shown in the block diagram in Figure 3. They are:

- A fully integrated oscillator that provides sawtooth to modulate the duty cycle and the synchronization signal. Its switching frequency can be adjusted by an external resistor. The voltage and frequency feed-forward are implemented.
- The soft-start circuitry to limit inrush current during the startup phase.
- The voltage mode error amplifier.
- The pulse width modulator and the relative logic circuitry necessary to drive the internal power switch.
- The high-side driver for embedded P-channel power MOSFET switch.
- The peak current limit sensing block, to handle overload and short-circuit conditions.
- A voltage regulator and internal reference. To supply the internal circuitry and provide a fixed internal reference.
- A voltage monitor circuitry (UVLO) that checks the input and internal voltages.
- A thermal shutdown block, to prevent thermal runaway.

Figure 3. Block diagram
![img-3.jpeg](img-3.jpeg)# 5.1 Oscillator and synchronization 

Figure 4 shows the block diagram of the oscillator circuit. The internal oscillator provides a constant frequency clock. Its frequency depends on the resistor externally connected to the FSW pin. If the FSW pin is left floating, the frequency is 250 kHz ; it can be increased as shown in Figure 6 by an external resistor connected to ground.

To improve the line transient performance, keeping the PWM gain constant versus the input voltage, the voltage feed-forward is implemented by changing the slope of the sawtooth according to the input voltage change (see Figure 5.a).

The slope of the sawtooth also changes if the oscillator frequency is increased by the external resistor. In this way a frequency feed-forward is implemented (Figure 5.b) in order to keep the PWM gain constant versus the switching frequency (see Section 6.4 on page 20 for PWM gain expression).

On the SYNCH pin the synchronization signal is generated. This signal has a phase shift of $180^{\circ}$ with respect to the clock. This delay is useful when two devices are synchronized connecting the SYNCH pins together. When SYNCH pins are connected, the device with a higher oscillator frequency typically works as a master, so the slave device switches at the frequency of the master but with a delay of half a period. This minimizes the RMS current flowing through the input capacitor (see the L5988D datasheet).

The SYNCH circuitry is also able to synchronize with a slightly lower external frequency, so the frequency pre-adjustment with the same resistor on the FSW pin, as described below, is suggested for a proper operation.

Figure 4. Oscillator circuit block diagram
![img-4.jpeg](img-4.jpeg)

The device can be synchronized to work at a higher frequency feeding an external clock signal. The synchronization changes the sawtooth amplitude, changing the PWM gain (Figure 5.c). This change must be taken into account when the loop stability is studied. To minimize the change of PWM gain, the free-running frequency should be set (with a resistor on the FSW pin) only slightly lower than the external clock frequency. This pre-adjusting of the frequency changes the sawtooth slope in order to render the truncation of sawtooth negligible, due to the external synchronization.Figure 5. Sawtooth: voltage and frequency feed-forward; external synchronization
![img-5.jpeg](img-5.jpeg)

Figure 6. Oscillator frequency vs. FSW pin resistor
![img-6.jpeg](img-6.jpeg)# 5.2 Soft-start 

The soft-start is essential to assure correct and safe startup of the step-down converter. It avoids inrush current surge and makes the output voltage increase monothonically.
The soft-start is performed by a staircase ramp on the non inverting input ( $\mathrm{V}_{\text {REF }}$ ) of the error amplifier. So the output voltage slew rate is:

## Equation 1

$$
S R_{\text {OUT }}=S R_{V R E F} \cdot\left(1+\frac{R 1}{R 2}\right)
$$

where $S R_{V R E F}$ is the slew rate of the non inverting input, while R1and R2 is the resistor divider to regulate the output voltage (see Figure 7). The soft-start staircase consists of 64 steps of 9.5 mV each, from 0 V to 0.6 V . The time base of one step is of 32 clock cycles. So the soft-start time and then the output voltage slew rate depend on the switching frequency.

Figure 7. Soft-start scheme
![img-7.jpeg](img-7.jpeg)

Soft-start time results:

## Equation 2

$$
S S_{\text {TIME }}=\frac{32 \cdot 64}{F_{S W}}
$$

For example, with a switching frequency of 250 kHz , the $\mathrm{SS}_{\text {TIME }}$ is 8 ms .# 5.3 Error amplifier and compensation 

The error amplifier ( $\mathrm{E} / \mathrm{A}$ ) provides the error signal to be compared with the sawtooth to perform the pulse width modulation. Its non inverting input is internally connected to a 0.6 V voltage reference, while its inverting input (FB) and output (COMP) are externally available for feedback and frequency compensation. In this device the error amplifier is a voltage mode operational amplifier, therefore, with high DC gain and low output impedance.

The uncompensated error amplifier characteristics are the following:
Table 5. Uncompensated error amplifier characteristics

| Parameter | Value |
| :--: | :--: |
| Low frequency gain | 100 dB |
| GBWP | 4.5 MHz |
| Slew rate | $7 \mathrm{~V} / \mu \mathrm{s}$ |
| Output voltage swing | 0 to 3.3 V |
| Maximum source/sink current | $17 \mathrm{~mA} / 25 \mathrm{~mA}$ |

In continuous conduction mode (CCM), the transfer function of the power section has two poles due to the LC filter and one zero due to the ESR of the output capacitor. Different kinds of compensation networks can be used depending on the ESR value of the output capacitor. If the zero introduced by the output capacitor helps to compensate the double pole of the LC filter, a type II compensation network can be used. Otherwise, a type III compensation network must be used (see Section 6.4 on page 20 for details of the compensation network selection).

Anyway, the methodology to compensate the loop is to introduce zeroes to obtain a safe phase margin.

### 5.4 Overcurrent protection

The L7986 device implements overcurrent protection by sensing current flowing through the power MOSFET. Due to the noise created by the switching activity of the power MOSFET, the current sensing is disabled during the initial phase of the conduction time. This avoids an erroneous detection of a fault condition. This interval is generally known as "masking time" or "blanking time". The masking time is about 200 ns .

If the overcurrent limit is reached, the power MOSFET is turned off implementing pulse by pulse overcurrent protection. In the overcurrent condition, the device can skip turn-on pulses in order to keep the output current constant and equal to the current limit. If, at the end of the "masking time", the current is higher than the overcurrent threshold, the power MOSFET is turned off and one pulse is skipped. If, at the following switching on, when the "masking time" ends, the current is still higher than the overcurrent threshold, the device skips two pulses. This mechanism is repeated and the device can skip up to seven pulses. While, if at the end of the "masking time", the current is lower than the overcurrent threshold, the number of skipped cycles is decreased by one unit (see Figure 8).

So, the overcurrent/short-circuit protection acts by switching off the power MOSFET and reducing the switching frequency down to one eighth of the default switching frequency, in order to keep constant the output current around the current limit.This kind of overcurrent protection is effective if the output current is limited. To prevent the current from diverging, the current ripple in the inductor during the on-time must not be higher than the current ripple during the off-time. That is:

# Equation 3 

$$
\frac{V_{\text {IN }}-V_{\text {OUT }}-R_{\text {DSON }} \cdot I_{\text {OUT }}-D C R \cdot I_{\text {OUT }}}{L \cdot F_{S W}} \cdot D=\frac{V_{\text {OUT }}+V_{F}+R_{\text {DSON }} \cdot I_{\text {OUT }}+D C R \cdot I_{\text {OUT }}}{L \cdot F_{S W}} \cdot(1-D)
$$

If the output voltage is shorted, $\mathrm{V}_{\text {OUT }} \cong 0, \mathrm{I}_{\text {OUT }}=\mathrm{I}_{\mathrm{LIM}}, \mathrm{D} / \mathrm{F}_{\mathrm{SW}}=\mathrm{T}_{\mathrm{ON} \_ \text {MIN }}$, $(1-D) / F_{S W} \cong 1 / F_{S W}$. So, from Equation 3, the maximum switching frequency that guarantees to limit the current results:

## Equation 4

$$
F_{S W}^{*}=\frac{\left(V_{F}+D C R \cdot I_{L I M}\right)}{\left(V_{I N}-\left(R_{D S O N}+D C R\right) \cdot I_{L I M}\right)} \cdot \frac{1}{T_{O N \_M I N}}
$$

With $R_{\text {DSON }}=300 \mathrm{~m} \Omega, D C R=0.08 \Omega$, the worst condition is with $V_{I N}=38 \mathrm{~V}, I_{L I M}=3.7 \mathrm{~A}$; the maximum frequency to keep the output current limited during the short-circuit results 88 kHz .

The pulse-by-pulse mechanism, which reduces the switching frequency down to one eighth the maximum $\mathrm{F}_{\mathrm{SW}}$, adjusted by the FSW pin, that assures a full effective output current limitation, is $88 \mathrm{kHz} * 8=706 \mathrm{kHz}$.

If, with $V_{I N}=38 \mathrm{~V}$, the switching frequency is set higher than 706 kHz , during short-circuit condition the system finds a different equilibrium with higher current. For example, with $\mathrm{F}_{\mathrm{SW}}=800 \mathrm{kHz}$ and the output shorted to ground, the output current is limited around:

## Equation 5

$$
I_{\text {OUT }}=\frac{V_{\text {IN }} \cdot F_{S W}^{*}-V_{F} / T_{O N \_M I N}}{\left(D C R / T_{O N \_M I N}\right)+\left(R_{D S O N}+D C R\right) \cdot F_{S W}^{*}}=4.2 \mathrm{~A}
$$

where $F_{S W}{ }^{*}$ is 800 kHz divided by eight.Figure 8. Overcurrent protection
![img-8.jpeg](img-8.jpeg)

# 5.5 Enable function 

The enable feature allows to put the device into standby mode. With the EN pin lower than 0.3 V the device is disabled and the power consumption is reduced to less than $30 \mu \mathrm{~A}$. With the EN pin lower than 1.2 V , the device is enabled. If the EN pin is left floating, an internal pull-down ensures that the voltage at the pin reaches the inhibit threshold and the device is disabled. The pin is also $\mathrm{V}_{\mathrm{CC}}$ compatible.

### 5.6 Hysteretic thermal shutdown

The thermal shutdown block generates a signal that turns off the power stage if the junction temperature goes above $150^{\circ} \mathrm{C}$. Once the junction temperature returns to about $120^{\circ} \mathrm{C}$, the device restarts in normal operation. The sensing element is very close to the PDMOS area, so ensuring an accurate and fast temperature detection.# 6 Application information 

### 6.1 Input capacitor selection

The capacitor connected to the input must be capable of supporting the maximum input operating voltage and the maximum RMS input current required by the device. The input capacitor is subject to a pulsed current, the RMS value of which is dissipated over its ESR, affecting the overall system efficiency.
So, the input capacitor must have an RMS current rating higher than the maximum RMS input current and an ESR value compliant with the expected efficiency.

The maximum RMS input current flowing through the capacitor can be calculated as:

## Equation 6

$$
\mathrm{I}_{\mathrm{RMS}}=\mathrm{I}_{\mathrm{O}} \cdot \sqrt{\mathrm{D}-\frac{2 \cdot \mathrm{D}^{2}}{\eta}+\frac{\mathrm{D}^{2}}{\eta^{2}}}
$$

where $I_{O}$ is the maximum DC output current, $D$ is the duty cycle, $\eta$ is the efficiency. Considering $\eta=1$, this function has a maximum at $D=0.5$ and it is equal to $\mathrm{I}_{\mathrm{O}} / 2$.

In a specific application, the range of possible duty cycles must be considered in order to find out the maximum RMS input current. The maximum and minimum duty cycles can be calculated as:

## Equation 7

$$
D_{M A X}=\frac{V_{O U T}+V_{F}}{V_{I N M I N}-V_{S W}}
$$

and

## Equation 8

$$
D_{\text {MIN }}=\frac{V_{\text {OUT }}+V_{F}}{V_{\text {INMAX }}-V_{S W}}
$$

where $V_{F}$ is the forward voltage on the freewheeling diode and $V_{S W}$ is the voltage drop across the internal PDMOS.

The peak-to-peak voltage across the input capacitor can be calculated as:

## Equation 9

$$
\mathrm{V}_{\mathrm{PP}}=\frac{\mathrm{I}_{\mathrm{O}}}{\mathrm{C}_{\mathrm{IN}} \cdot \mathrm{~F}_{\mathrm{SW}}} \cdot\left[\left(1-\frac{\mathrm{D}}{\eta}\right) \cdot \mathrm{D}+\frac{\mathrm{D}}{\eta} \cdot(1-\mathrm{D})\right]+\mathrm{ESR} \cdot \mathrm{I}_{\mathrm{O}}
$$

where $E S R$ is the equivalent series resistance of the capacitor.
Given the physical dimension, ceramic capacitors can well meet the requirements of the input filter sustaining a higher input RMS current than electrolytic/tantalum types.In this case the equation of $\mathrm{C}_{\mathrm{IN}}$ as a function of the target $\mathrm{V}_{\mathrm{PP}}$ can be written as follows:

# Equation 10 

$$
C_{I N}=\frac{I_{O}}{V_{P P} \cdot F_{S W}} \cdot\left[\left(1-\frac{D}{\eta}\right) \cdot D+\frac{D}{\eta} \cdot(1-D)\right]
$$

neglecting the small ESR of ceramic capacitors.
Considering $\eta=1$, this function has its maximum in $D=0.5$, therefore, given the maximum peak-to-peak input voltage ( $\mathrm{V}_{\mathrm{PP} \_ \mathrm{MAX}}$ ), the minimum input capacitor ( $\mathrm{C}_{\mathrm{IN} \_\mathrm{MIN}}$ ) value is:

## Equation 11

$$
\mathrm{C}_{\mathrm{IN} \_\mathrm{MIN}}=\frac{\mathrm{I}_{\mathrm{O}}}{2 \cdot \mathrm{~V}_{\mathrm{PP} \_ \mathrm{MAX}} \cdot \mathrm{~F}_{\mathrm{SW}}}
$$

Typically $C_{I N}$ is dimensioned to keep the maximum peak-to-peak voltage in the order of $1 \%$ of $\mathrm{V}_{\text {INMAX }}$.
In Table 6 some multi-layer ceramic capacitors suitable for this device are reported.
Table 6. Input MLCC capacitors

| Manufacture | Series | Cap value $(\mu \mathrm{F})$ | Rated voltage $(\mathrm{V})$ |
| :--: | :--: | :--: | :--: |
| Taiyo Yuden | UMK325BJ106MM-T | 10 | 50 |
|  | GMK325BJ106MN-T | 10 | 35 |
| Murata | GRM32ER71H475K | 4.7 | 50 |

A ceramic bypass capacitor, as close to the VCC and GND pins as possible, so that additional parasitic ESR and ESL are minimized, is suggested in order to prevent instability on the output voltage due to noise. The value of the bypass capacitor can go from 100 nF to $1 \mu \mathrm{~F}$.

### 6.2 Inductor selection

The inductance value fixes the current ripple flowing through the output capacitor. So the minimum inductance value, in order to have the expected current ripple, must be selected. The rule to fix the current ripple value is to have a ripple at $20 \%-40 \%$ of the output current.
In the continuous current mode (CCM), the inductance value can be calculated by the following equation:

## Equation 12

$$
\Delta I_{L}=\frac{V_{I N}-V_{\text {OUT }}}{L} \cdot T_{O N}=\frac{V_{\text {OUT }}+V_{F}}{L} \cdot T_{O F F}
$$

where $T_{O N}$ is the conduction time of the internal high-side switch and $T_{O F F}$ is the conduction time of the external diode [in CCM, $\mathrm{F}_{\mathrm{SW}}=1 /\left(\mathrm{T}_{\mathrm{ON}}+\mathrm{T}_{\mathrm{OFF}}\right)$ ]. The maximum current ripple, at fixed $\mathrm{V}_{\text {OUT }}$, is obtained at maximum $\mathrm{T}_{\text {OFF }}$ which is at minimum duty cycle (see Section 6.1 to calculate minimum duty). So, by fixing $\Delta I_{L}=20 \%$ to $30 \%$ of the maximum output current, the minimum inductance value can be calculated:# Equation 13 

$$
\mathrm{L}_{\mathrm{MIN}}=\frac{\mathrm{V}_{\mathrm{OUT}}+\mathrm{V}_{\mathrm{F}}}{\Delta \mathrm{I}_{\mathrm{MAX}}} \cdot \frac{1-\mathrm{D}_{\mathrm{MIN}}}{\mathrm{~F}_{\mathrm{SW}}}
$$

where $F_{S W}$ is the switching frequency, $1 /\left(\mathrm{T}_{\mathrm{ON}}+\mathrm{T}_{\mathrm{OFF}}\right)$.
For example, for $\mathrm{V}_{\mathrm{OUT}}=5 \mathrm{~V}, \mathrm{~V}_{\mathrm{IN}}=24 \mathrm{~V}, \mathrm{I}_{\mathrm{O}}=3 \mathrm{~A}$ and $\mathrm{F}_{\mathrm{SW}}=250 \mathrm{kHz}$, the minimum inductance value to have $\Delta \mathrm{I}_{\mathrm{L}}=30 \%$ of $\mathrm{I}_{\mathrm{O}}$ is about $18 \mu \mathrm{H}$.

The peak current through the inductor is given by:

## Equation 14

$$
\mathrm{I}_{\mathrm{L}, \mathrm{PK}}=\mathrm{I}_{\mathrm{O}}+\frac{\Delta \mathrm{I}_{\mathrm{L}}}{2}
$$

So, if the inductor value decreases, then the peak current (that must be lower than the minimum current limit of the device) increases. According to the maximum DC output current for this product family (3 A), the higher the inductor value, the higher the average output current that can be delivered, without triggering the overcurrent protection.

In Table 7 some inductor part numbers are listed.
Table 7. Inductors

| Manufacturer | Series | Inductor value $(\mu \mathrm{H})$ | Saturation current (A) |
| :--: | :--: | :--: | :--: |
| Coilcraft | MSS1038 | 3.8 to 10 | 3.9 to 6.5 |
|  | MSS1048 | 12 to 22 | 3.84 to 5.34 |
| Wurth | PD type L | 8.2 to 15 | 3.75 to 6.25 |
|  | PD type M | 2.2 to 4.7 | 4 to 6 |
| SUMIDA | CDRH6D226/HP | 1.5 to 3.3 | 3.6 to 5.2 |
|  | CDR10D48MN | 6.6 to 12 | 4.1 to 5.7 |

### 6.3 Output capacitor selection

The current in the capacitor has a triangular waveform which generates a voltage ripple across it. This ripple is due to the capacitive component (charge or discharge of the output capacitor) and the resistive component (due to the voltage drop across its ESR). So the output capacitor must be selected in order to have a voltage ripple compliant with the application requirements.

The amount of the voltage ripple can be calculated starting from the current ripple obtained by the inductor selection.

## Equation 15

$$
\Delta \mathrm{V}_{\mathrm{OUT}}=\mathrm{ESR} \cdot \Delta \mathrm{I}_{\mathrm{MAX}}+\frac{\Delta \mathrm{I}_{\mathrm{MAX}}}{8 \cdot \mathrm{C}_{\mathrm{OUT}} \cdot \mathrm{I}_{\mathrm{SW}}}
$$

Usually the resistive component of the ripple is much higher than the capacitive one, if the output capacitor adopted is not a multi-layer ceramic capacitor (MLCC) with very low ESR value.The output capacitor is important also for loop stability: it fixes the double LC filter pole and the zero due to its ESR. Section 6.4 illustrates how to consider its effect in the system stability.
For example, with $\mathrm{V}_{\text {OUT }}=5 \mathrm{~V}, \mathrm{~V}_{\mathrm{IN}}=24 \mathrm{~V}, \Delta \mathrm{I}_{\mathrm{L}}=0.9 \mathrm{~A}$ (resulting from the inductor value), in order to have a $\Delta \mathrm{V}_{\text {OUT }}=0.01 \cdot \mathrm{~V}_{\text {OUT }}$, if the multi-layer ceramic capacitors are adopted, $10 \mu \mathrm{~F}$ are needed and the ESR effect on the output voltage ripple can be neglected. In the case of non-negligible ESR (electrolytic or tantalum capacitors), the capacitor is chosen taking into account its ESR value. So, in case of $330 \mu \mathrm{~F}$ with $\mathrm{ESR}=30 \mathrm{~m} \Omega$, the resistive component of the drop dominates and the voltage ripple is 28 mV .
The output capacitor is also important to sustain the output voltage when a load transient with high slew rate is required by the load. When the load transient slew rate exceeds the system bandwidth, the output capacitor provides the current to the load. So, if the high slew rate load transient is required by the application, the output capacitor and system bandwidth must be chosen in order to sustain the load transient.

In Table 8 some capacitor series are listed.
Table 8. Output capacitors

| Manufacturer | Series | Cap value $(\mu \mathrm{F})$ | Rated voltage $(\mathrm{V})$ | ESR $(\mathrm{m} \Omega)$ |
| :--: | :--: | :--: | :--: | :--: |
| MURATA | GRM32 | 22 to 100 | 6.3 to 25 | $<5$ |
|  | GRM31 | 10 to 47 | 6.3 to 25 | $<5$ |
| PANASONIC | ECJ | 10 to 22 | 6.3 | $<5$ |
|  | EEFCD | 10 to 68 | 6.3 | 15 to 55 |
| SANYO | TPA/B/C | 100 to 470 | 4 to 16 | 40 to 80 |
| TDK | C3225 | 22 to 100 | 6.3 | $<5$ |

# 6.4 Compensation network 

The compensation network must assure stability and good dynamic performance. The loop of the L7986 is based on the voltage mode control. The error amplifier is a voltage operational amplifier with high bandwidth. So, by selecting the compensation network the E/A is considered as ideal, that is, its bandwidth is much larger than the system one.
The transfer functions of the PWM modulator and the output LC filter are studied (see Figure 10). The transfer function of the PWM modulator, from the error amplifier output (COMP pin) to the OUT pin, results:

## Equation 16

$$
\mathrm{G}_{\mathrm{PW} 0}=\frac{\mathrm{V}_{\mathrm{IN}}}{\mathrm{~V}_{\mathrm{S}}}
$$

where $V_{S}$ is the sawtooth amplitude. As seen in Section 5.1 on page 11, the voltage feedforward generates a sawtooth amplitude directly proportional to the input voltage, that is:

## Equation 17

$$
\mathrm{V}_{\mathrm{S}}=\mathrm{K} \cdot \mathrm{~V}_{\mathrm{IN}}
$$In this way the PWM modulator gain results constant and equal to:

# Equation 18 

$$
\mathrm{G}_{\mathrm{PW} 0}=\frac{\mathrm{V}_{\mathrm{IN}}}{\mathrm{~V}_{\mathrm{s}}}=\frac{1}{\mathrm{~K}}=18
$$

The synchronization of the device with an external clock provided through the SYNCH pin can modify the PWM modulator gain (see Section 5.1 on page 11 to understand how this gain changes and how to keep it constant in spite of the external synchronization).

Figure 9. The error amplifier, the PWM modulator, and the LC output filter
![img-9.jpeg](img-9.jpeg)

The transfer function on the LC filter is given by:

## Equation 19

$$
\mathrm{G}_{\mathrm{LC}}(\mathrm{~s})=\frac{1+\frac{5}{2 \pi \cdot \mathrm{f}_{\mathrm{zESR}}}}{1+\frac{5}{2 \pi \cdot \mathrm{Q} \cdot \mathrm{f}_{\mathrm{LC}}}+\left(\frac{5}{2 \pi \cdot \mathrm{f}_{\mathrm{LC}}}\right)^{2}}
$$

where:

## Equation 20

$$
\mathrm{f}_{\mathrm{LC}}=\frac{1}{2 \pi \cdot \sqrt{\mathrm{~L} \cdot \mathrm{C}_{\mathrm{OUT}} \cdot \sqrt{1+\mathrm{ESR}}}}, \quad \mathrm{f}_{\mathrm{zESR}}=\frac{1}{2 \pi \cdot \mathrm{ESR} \cdot \mathrm{C}_{\mathrm{OUT}}}
$$

## Equation 21

$$
\mathrm{Q}=\frac{\sqrt{\mathrm{R}_{\mathrm{OUT}} \cdot \mathrm{~L} \cdot \mathrm{C}_{\mathrm{OUT}} \cdot\left(\mathrm{R}_{\mathrm{OUT}}+\mathrm{ESR}\right)}}{\mathrm{L}+\mathrm{C}_{\mathrm{OUT}} \cdot \mathrm{R}_{\mathrm{OUT}} \cdot \mathrm{ESR}}, \quad \mathrm{R}_{\mathrm{OUT}}=\frac{\mathrm{V}_{\mathrm{OUT}}}{\mathrm{f}_{\mathrm{OUT}}}
$$As seen in Section 5.3 on page 14, two different kinds of network can compensate the loop. In the following two paragraphs the guidelines to select the type II and type III compensation network are illustrated.

# 6.4.1 Type III compensation network 

The methodology to stabilize the loop consists of placing two zeroes to compensate the effect of the LC double pole, therefore increasing phase margin; then, to place one pole in the origin to minimize the DC error on regulated output voltage; and finally, to place other poles far from the zero dB frequency.

If the equivalent series resistance (ESR) of the output capacitor introduces a zero with a frequency higher than the desired bandwidth (that is: $2 \pi * \mathrm{ESR} * \mathrm{C}_{\text {OUT }}<1 / \mathrm{BW}$ ), the type III compensation network is needed. Multi-layer ceramic capacitors (MLCC) have very low ESR ( $<1 \mathrm{~m} \Omega$ ), with very high frequency zero, so a type III network is adopted to compensate the loop.

In Figure 10 the type III compensation network is shown. This network introduces two zeroes $\left(f_{Z 1}, f_{Z 2}\right)$ and three poles $\left(f_{P 0}, f_{P 1}, f_{P 2}\right)$. They are expressed as:

## Equation 22

$$
f_{Z 1}=\frac{1}{2 \pi \cdot C_{3} \cdot\left(R_{1}+R_{3}\right)}, \quad f_{Z 2}=\frac{1}{2 \pi \cdot R_{4} \cdot C_{4}}
$$

## Equation 23

$$
f_{P 0}=0, \quad f_{P 1}=\frac{1}{2 \pi \cdot R_{3} \cdot C_{3}}, \quad f_{P 2}=\frac{1}{2 \pi \cdot R_{4} \cdot \frac{C_{4} \cdot C_{5}}{C_{4}+C_{5}}}
$$

Figure 10. Type III compensation network
![img-10.jpeg](img-10.jpeg)In Figure 11 the Bode diagram of the PWM and LC filter transfer function [G $\mathrm{G}_{\mathrm{PW} 0} \cdot \mathrm{G}_{\mathrm{LC}}(\mathrm{f})$ ] and the open-loop gain $\left[\mathrm{G}_{\mathrm{LOOP}}(\mathrm{f}) \simeq \mathrm{G}_{\mathrm{PW} 0} \cdot \mathrm{G}_{\mathrm{LC}}(\mathrm{f}) \cdot \mathrm{G}_{\text {TYPEIII }}(\mathrm{f})\right]$ are drawn.

Figure 11. Open-loop gain: module Bode diagram
![img-11.jpeg](img-11.jpeg)

The guidelines for positioning the poles and the zeroes and for calculating the component values can be summarized as follows:

1. Choose a value for $R_{1}$, usually between $1 \mathrm{k} \Omega$ and $5 \mathrm{k} \Omega$.
2. Choose a gain $\left(R_{4} / R_{1}\right)$ in order to have the required bandwidth (BW), that means:

# Equation 24 

$$
R_{4}=\frac{B W}{f_{L C}} \cdot K \cdot R_{1}
$$

where $K$ is the feed-forward constant and $1 / K$ is equal to 18 .
3. Calculate $C_{4}$ by placing the zero at $50 \%$ of the output filter double pole frequency $\left(f_{L C}\right)$ :

## Equation 25

$$
C_{4}=\frac{1}{\pi \cdot R_{4} \cdot f_{L C}}
$$

4. Calculate $C_{5}$ by placing the second pole at four times the system bandwidth (BW):

## Equation 26

$$
C_{5}=\frac{C_{4}}{2 \pi \cdot R_{4} \cdot C_{4} \cdot 4 \cdot B W-1}
$$

5. Set also the first pole at four times the system bandwidth and also the second zero at the output filter double pole:# Equation 27 

$$
R_{3}=\frac{R_{1}}{\frac{4 \cdot B W}{f_{L C}}-1}, \quad C_{3}=\frac{1}{2 \pi \cdot R_{3} \cdot 4 \cdot B W}
$$

The suggested maximum system bandwidth is equal to the switching frequency divided by $3.5\left(F_{S W} / 3.5\right)$, anyway, lower than 100 kHz if the $\mathrm{F}_{\mathrm{SW}}$ is set higher than 500 kHz .
For example, with $\mathrm{V}_{\text {OUT }}=5 \mathrm{~V}, \mathrm{~V}_{\mathrm{IN}}=24 \mathrm{~V}, \mathrm{I}_{\mathrm{O}}=3 \mathrm{~A}, \mathrm{~L}=18 \mu \mathrm{H}, \mathrm{C}_{\text {OUT }}=22 \mu \mathrm{~F}, \mathrm{ESR}<1 \mathrm{~m} \Omega$, the type III compensation network is:

$$
R_{1}=4.99 \mathrm{k} \Omega, \quad R_{2}=680 \Omega, \quad R_{3}=200 \Omega, \quad R_{4}=2 \mathrm{k} \Omega, \quad C_{3}=3.3 \mathrm{nF}, \quad C_{4}=22 \mathrm{nF}, \quad C_{5}=220 \mathrm{pF}
$$

In Figure 12 the module and phase of the open-loop gain is shown. The bandwidth is about 58 kHz and the phase margin is $50^{\circ}$.Figure 12. Open-loop gain Bode diagram with ceramic output capacitor
![img-12.jpeg](img-12.jpeg)# 6.4.2 Type II compensation network 

If the equivalent series resistance (ESR) of the output capacitor introduces a zero with a frequency lower than the desired bandwidth (that is: $2 \pi * \mathrm{ESR} * \mathrm{C}_{\text {OUT }}>1 / \mathrm{BW}$ ), this zero helps stabilize the loop. Electrolytic capacitors show non-negligible ESR ( $>30 \mathrm{~m} \Omega$ ), so with this kind of output capacitor the type II network combined with the zero of the ESR allows to stabilize the loop.

In Figure 13 the type II network is shown.
Figure 13. Type II compensation network
![img-13.jpeg](img-13.jpeg)

The singularities of the network are:
Equation 28

$$
f_{Z 1}=\frac{1}{2 \pi \cdot R_{4} \cdot C_{4}}, \quad f_{P 0}=0, \quad f_{P 1}=\frac{1}{2 \pi \cdot R_{4} \cdot \frac{C_{4} \cdot C_{5}}{C_{4}+C_{5}}}
$$In Figure 14 the Bode diagram of the PWM and LC filter transfer function [G $\mathrm{G}_{\mathrm{PW} 0} \cdot \mathrm{G}_{\mathrm{LC}}(\mathrm{f})$ ] and the open-loop gain $\left[\mathrm{G}_{\mathrm{LOOP}}(\mathrm{f}) \simeq \mathrm{G}_{\mathrm{PW} 0} \cdot \mathrm{G}_{\mathrm{LC}}(\mathrm{f}) \cdot \mathrm{G}_{\text {TYPEII }}(\mathrm{f})\right]$ are drawn.

Figure 14. Open-loop gain: module Bode diagram
![img-14.jpeg](img-14.jpeg)

The guidelines for positioning the poles and the zeroes and for calculating the component values can be summarized as follows:

1. Choose a value for $R_{1}$, usually between $1 \mathrm{k} \Omega$ and $5 \mathrm{k} \Omega$, in order to have values of C 4 and C 5 not comparable with parasitic capacitance of the board.
2. Choose a gain $\left(R_{4} / R_{1}\right)$ in order to have the required bandwidth (BW), that means:

# Equation 29 

$$
R_{4}=\left(\frac{f_{E S R}}{f_{L C}}\right)^{2} \cdot \frac{B W}{f_{E S R}} \cdot \frac{V_{S}}{V_{I N}} \cdot R_{1}
$$

where $f_{E S R}$ is the ESR zero:

## Equation 30

$$
f_{E S R}=\frac{1}{2 \pi \cdot E S R \cdot C_{O U T}}
$$

and $V_{S}$ is the sawtooth amplitude. The voltage feed-forward keeps the ratio $\mathrm{V}_{\mathrm{S}} / \mathrm{V}_{\mathrm{IN}}$ constant.
3. Calculate $C_{4}$ by placing the zero one decade below the output filter double pole:

## Equation 31

$$
C_{4}=\frac{10}{2 \pi \cdot R_{4} \cdot f_{L C}}
$$

4. Then calculate $C_{3}$ in order to place the second pole at four times the system bandwidth (BW):

## Equation 32

$$
C_{5}=\frac{C_{4}}{2 \pi \cdot R_{4} \cdot C_{4} \cdot 4 \cdot B W-1}
$$For example with $\mathrm{V}_{\text {OUT }}=5 \mathrm{~V}, \mathrm{~V}_{\mathrm{IN}}=24 \mathrm{~V}, \mathrm{I}_{\mathrm{O}}=3 \mathrm{~A}, \mathrm{~L}=18 \mu \mathrm{H}, \mathrm{C}_{\text {OUT }}=330 \mu \mathrm{~F}, \mathrm{ESR}=35 \mathrm{~m} \Omega$, the type II compensation network is:

$$
R_{1}=1.1 \mathrm{k} \Omega, \quad R_{2}=150 \Omega, \quad R_{4}=4.99 \mathrm{k} \Omega, \quad C_{4}=82 \mathrm{nF}, \quad C_{5}=68 \mathrm{pF}
$$

In Figure 15 the module and phase of the open-loop gain is shown. The bandwidth is about 21 kHz and the phase margin is $45^{\circ}$.

Figure 15. Open-loop gain Bode diagram with electrolytic/tantalum output capacitor
![img-15.jpeg](img-15.jpeg)# 6.5 Thermal considerations 

The thermal design is important to prevent the thermal shutdown of device if junction temperature goes above $150^{\circ} \mathrm{C}$. The three different sources of losses within the device are:
a) conduction losses due to the non-negligible $R_{D S(o n)}$ of the power switch; these are equal to:

## Equation 33

$$
P_{O N}=R_{D S O N} \cdot\left(I_{O U T}\right)^{2} \cdot D
$$

where $D$ is the duty cycle of the application and the maximum $R_{D S O N}$ overtemperature is $220 \mathrm{~m} \Omega$. Note that the duty cycle is theoretically given by the ratio between $V_{\text {OUT }}$ and $V_{\text {IN }}$, but actually it is quite higher to compensate the losses of the regulator. So the conduction losses increase compared with the ideal case.
b) switching losses due to power MOSFET turn ON and OFF; these can be calculated as:

## Equation 34

$$
P_{S W}=V_{I N} \cdot I_{O U T} \cdot \frac{\left(T_{R I S E}+T_{F A L L}\right)}{2} \cdot F_{S W}=V_{I N} \cdot I_{O U T} \cdot T_{S W} \cdot F_{S W}
$$

where $T_{\text {RISE }}$ and $T_{\text {FALL }}$ are the overlap times of the voltage across the power switch ( $\mathrm{V}_{\mathrm{DS}}$ ) and the current flowing into it during turn ON and turn OFF phases, as shown in Figure 16. $\mathrm{T}_{\mathrm{SW}}$ is the equivalent switching time. For this device the typical value for the equivalent switching time is 40 ns .
c) Quiescent current losses, calculated as:

## Equation 35

$$
P_{Q}=V_{I N} \cdot I_{Q}
$$

where $I_{Q}$ is the quiescent current $\left(I_{Q}=2.4 \mathrm{~mA}\right)$.
The junction temperature $T_{J}$ can be calculated as:

## Equation 36

$$
T_{J}=T_{A}+R t h_{J A} \cdot P_{T O T}
$$

where $T_{A}$ is the ambient temperature and $P_{T O T}$ is the sum of the power losses just seen.
$\mathrm{Rth}_{\mathrm{JA}}$ is the equivalent thermal resistance junction to ambient of the device; it can be calculated as the parallel of many paths of heat conduction from the junction to the ambient. For this device the path through the exposed pad is the one conducting the largest amount of heat. The $\mathrm{Rth}_{\mathrm{JA}}$, measured on the demonstration board described in the following paragraph, is about $60^{\circ} \mathrm{C} / \mathrm{W}$ for the VFDFPN package and about $40^{\circ} \mathrm{C} / \mathrm{W}$ for the HSOP package.Figure 16. Switching losses
![img-16.jpeg](img-16.jpeg)

# 6.6 Layout considerations 

The PC board layout of the switching the DC/DC regulator is very important to minimize the noise injected in high impedance nodes and interference generated by the high switching current loops.

In a step-down converter the input loop (including the input capacitor, the power MOSFET and the freewheeling diode) is the most critical one. This is due to the fact that the high value pulsed currents are flowing through it. In order to minimize the EMI, this loop must be as short as possible.

The feedback pin (FB) connection to the external resistor divider is a high impedance node, so the interference can be minimized by placing the routing of the feedback node as far as possible from the high current paths. To reduce the pick-up noise, the resistor divider must be placed very close to the device.

To filter the high frequency noise, a small bypass capacitor ( $220 \mathrm{nF}-1 \mu \mathrm{~F}$ ) can be added as close as possible to the input voltage pin of the device.

Thanks to the exposed pad of the device, the ground plane helps to reduce the thermal resistance junction to ambient; so a large ground plane enhances the thermal performance of the converter allowing high power conversion.In Figure 17 a layout example is shown.
Figure 17. Layout example
![img-17.jpeg](img-17.jpeg)# 6.7 Application circuit 

In Figure 18 the demonstration board application circuit is shown.
Figure 18. Demonstration board application circuit
![img-18.jpeg](img-18.jpeg)

Table 9. Component list

| Reference | Part number | Description | Manufacturer |
| :--: | :--: | :--: | :--: |
| C1 | UMK325BJ106MM-T | $10 \mu \mathrm{~F}, 50 \mathrm{~V}$ | Taiyo Yuden |
| C2 | GRM32ER61E226KE15 | $22 \mu \mathrm{~F}, 25 \mathrm{~V}$ | Murata |
| C3 |  | $3.3 \mathrm{nF}, 50 \mathrm{~V}$ |  |
| C4 |  | $33 \mathrm{nF}, 50 \mathrm{~V}$ |  |
| C5 |  | $100 \mathrm{pF}, 50 \mathrm{~V}$ |  |
| C6 |  | $470 \mathrm{nF}, 50 \mathrm{~V}$ |  |
| R1 |  | $4.99 \mathrm{k} \Omega, 1 \%, 0.1 \mathrm{~W} 0603$ |  |
| R2 |  | $1.1 \mathrm{k} \Omega, 1 \%, 0.1 \mathrm{~W} 0603$ |  |
| R3 |  | $330 \Omega, 1 \%, 0.1 \mathrm{~W} 0603$ |  |
| R4 |  | $1.5 \mathrm{k} \Omega, 1 \%, 0.1 \mathrm{~W} 0603$ |  |
| R5 |  | $180 \mathrm{k} \Omega, 1 \%, 0.1 \mathrm{~W} 0603$ |  |
| D1 | STPS3L40 | 3A DC, 40 V | STMicroelectronics |
| L1 | MSS1038-103NL | $\begin{gathered} 10 \mu \mathrm{H}, 30 \%, 3.9 \mathrm{~A} \\ \mathrm{DCR}_{\mathrm{MAX}}=35 \mathrm{~m} \Omega \end{gathered}$ | Coilcraft |Figure 19. PCB layout: L7986 and L7986A (component side)
![img-19.jpeg](img-19.jpeg)

Figure 20. PCB layout: L7986 and L7986A (bottom side)
![img-20.jpeg](img-20.jpeg)

Figure 21. PCB layout: L7986 and L7986A (front side)
![img-21.jpeg](img-21.jpeg)Figure 22. Junction temperature vs. output current $V_{I N}=24 \mathrm{~V}$
![img-22.jpeg](img-22.jpeg)

Figure 23. Junction temperature vs. output current $V_{I N}=12 \mathrm{~V}$
![img-23.jpeg](img-23.jpeg)

Figure 25. Efficiency vs. output current $V_{O}=1.8 \mathrm{~V}$
![img-24.jpeg](img-24.jpeg)

Figure 26. Efficiency vs.output current $\mathrm{V}_{\mathrm{O}}=5.0 \mathrm{~V}$
![img-25.jpeg](img-25.jpeg)

Figure 27. Efficiency vs.output current $\mathrm{V}_{\mathrm{O}}=3.3 \mathrm{~V}$
![img-26.jpeg](img-26.jpeg)![img-27.jpeg](img-27.jpeg)

Figure 28. Load regulation
![img-28.jpeg](img-28.jpeg)

Figure 30. Load transient: from 0.4 A to 2 A
![img-29.jpeg](img-29.jpeg)

Figure 32. Short-circuit behavior $\mathrm{V}_{\mathrm{IN}}=12 \mathrm{~V}$
![img-30.jpeg](img-30.jpeg)

Figure 33. Short-circuit behavior $\mathrm{V}_{\mathrm{IN}}=24 \mathrm{~V}$
![img-31.jpeg](img-31.jpeg)# 7 Application ideas 

### 7.1 Positive buck-boost

The L7986 device can implement the step-up/down converter with a positive output voltage.
Figure 34 shows the schematic: one power MOSFET and one Schottky diode are added to the standard buck topology to provide 12 V output voltage with input voltage from 4.5 V to 38 V .

Figure 34. Positive buck-boost regulator
![img-32.jpeg](img-32.jpeg)

The relationship between input and output voltage is:

## Equation 37

$$
\mathrm{V}_{\mathrm{OUT}}=\mathrm{V}_{\mathrm{IN}} \cdot \frac{\mathrm{D}}{1-\mathrm{D}}
$$

so the duty cycle is:

## Equation 38

$$
\mathrm{D}=\frac{\mathrm{V}_{\mathrm{OUT}}}{\mathrm{~V}_{\mathrm{OUT}}+\mathrm{V}_{\mathrm{IN}}}
$$

The output voltage isn't limited by the maximum operating voltage of the device ( 38 V ), because the output voltage is sensed only through the resistor divider. The external power MOSFET maximum drain to the source voltage, must be higher than the output voltage; the maximum gate to source voltage must be higher than the input voltage (in Figure 34, if $\mathrm{V}_{\text {IN }}$ is higher than 16 V , the gate must be protected through the Zener diode and resistor).
The current flowing through the internal power MOSFET is transferred to the load only during the off-time, so according to the maximum DC switch current (3.0 A), the maximum output current for the buck-boost topology can be calculated from equation 39.# Equation 39 

$$
I_{S W}=\frac{I_{\text {OUT }}}{1-D}<3 \mathrm{~A}
$$

where $I_{S W}$ is the average current in the embedded power MOSFET in the on-time.
To chose the right value of the inductor and to manage transient output current, that for a short time can exceed the maximum output current calculated by equation 39, also the peak current in the power MOSFET must be calculated. The peak current, shown in equation 40, must be lower than the minimum current limit (3.7 A).

## Equation 40

$$
I_{S W, P K}=\frac{I_{\text {OUT }}}{1-D}\left[1+\frac{r}{2}\right]<3.7 \mathrm{~A}
$$

where $r$ is defined as the ratio between the inductor current ripple and the inductor DC current:

So, in the buck-boost topology the maximum output current depends on the application conditions (firstly input and output voltage, secondly switching frequency and inductor value).

In Figure 35 the maximum output current for the above configuration is depicted varying the input voltage from 4.5 V to 38 V .

The dashed line considers a more accurate estimation of the duty cycles given by equation 41, where power losses across diodes, external power MOSFET, and internal power MOSFET are taken into account.

Figure 35. Maximum output current according to max DC switch current (3.0 A):
$\mathrm{V}_{\mathrm{O}}=12 \mathrm{~V}$
![img-33.jpeg](img-33.jpeg)# Equation 41 

$$
D=\frac{V_{\text {OUT }}+2 \cdot V_{D}}{V_{I N}-V_{S W}-V_{S W E}+V_{O U T}+2 \cdot V_{D}}
$$

where $V_{D}$ is the voltage drop across the diodes, $V_{S W}$ and $V_{S W E}$ across the internal and external power MOSFET.

### 7.2 Inverting buck-boost

The L7986 can implement the step-up/down converter with a negative output voltage.
Figure 34. shows the schematic to regulate -5 V : no further external components are added to the standard buck topology.

The relationship between input and output voltage is:

## Equation 42

$$
\mathrm{V}_{\text {OUT }}=-\mathrm{V}_{\mathrm{IN}} \cdot \frac{\mathrm{D}}{1-\mathrm{D}}
$$

so the duty cycle is:

## Equation 43

$$
D=\frac{V_{\text {OUT }}}{V_{\text {OUT }}-V_{\text {IN }}}
$$

As in the positive one, in the inverting buck-boost the current flowing through the power MOSFET is transferred to the load only during the off-time. So according to the maximum DC switch current ( 3.0 A ), the maximum output current can be calculated from the equation 39 , where the duty cycle is given by the equation 43.

Figure 36. Inverting buck-boost regulator
![img-34.jpeg](img-34.jpeg)

The GND pin of the device is connected to the output voltage so, given the output voltage, the input voltage range is limited by the maximum voltage the device can withstand across VCC and GND ( 38 V ). Therefore, if the output is -5 V the input voltage can range from 4.5 V to 33 V .As in the positive buck-boost, the maximum output current according to application conditions is shown in Figure 37. The dashed line considers a more accurate estimation of the duty cycles given by the equation 44 , where power losses across diodes and the internal power MOSFET are taken into account.

# Equation 44 

$$
D=\frac{V_{\text {OUT }}-V_{D}}{-V_{I N}-V_{S W}+V_{\text {OUT }}-V_{D}}
$$

Figure 37. Maximum output current according to switch max. peak current (3.0 A):
$\mathrm{V}_{\mathrm{O}}=-5 \mathrm{~V}$
![img-35.jpeg](img-35.jpeg)# 8 Package information 

In order to meet environmental requirements, ST offers these devices in different grades of ECOPACK packages, depending on their level of environmental compliance. ECOPACK specifications, grade definitions and product status are available at: www.st.com.
ECOPACK is an ST trademark.# 8.1 VFDFPN10 ( $3 \times 3 \times 1.0 \mathrm{~mm}$ ) package information 

Figure 38. VFDFPN10 ( $3 \times 3 \times 1.0 \mathrm{~mm}$ ) package outline
![img-36.jpeg](img-36.jpeg)Table 10. VFDFPN10 ( $3 \times 3 \times 1.0 \mathrm{~mm}$ ) package mechanical data

| Symbol | mm |  |  |
| :--: | :--: | :--: | :--: |
|  | Min. | Typ. | Max. |
| A | 0.80 | 0.90 | 1.00 |
| A1 |  | 0.02 | 0.05 |
| A2 | 0.55 | 0.65 | 0.80 |
| A3 |  | 0.20 |  |
| b | 0.18 | 0.25 | 0.30 |
| D | 2.85 | 3.00 | 3.15 |
| D2 | 2.20 |  | 2.70 |
| E | 2.85 | 3.00 | 3.15 |
| E2 | 1.40 |  | 1.75 |
| e |  | 0.50 |  |
| L | 0.30 | 0.40 | 0.50 |
| ddd |  |  | 0.08 |# 8.2 HSOP8 package information 

Figure 39. HSOP8 package outline
![img-37.jpeg](img-37.jpeg)Table 11. HSOP8 package mechanical data

| Symbol | mm |  |  |
| :--: | :--: | :--: | :--: |
|  | Min. | Typ. | Max. |
| A | 1.43 |  | 1.70 |
| A1 | 0.00 |  | 0.150 |
| A2 | 1.25 |  | 1.58 |
| b | 0.31 |  | 0.51 |
| c | 0.17 |  | 0.25 |
| D | 4.80 | 4.90 | 5.00 |
| E | 5.80 | 6.00 | 6.20 |
| E1 | 3.80 | 3.90 | 4.00 |
| e |  | 1.27 |  |
| h | 0.25 |  | 0.50 |
| L | 0.40 |  | 1.27 |
| k | 0.00 |  | 8.00 |
| ccc |  |  | 0.10 |# 9 Ordering information 

Table 12. Order code

| Order code | Package | Packing |
| :--: | :--: | :--: |
| L7986A | HSOP8 | Tube |
| L7986TR | VFDFPN10 | Tape and reel |
| L7986ATR | HSOP8 | Tape and reel |# 10 Revision history 

Table 13. Document revision history

| Date | Revision | Changes |
| :--: | :--: | :--: |
| 07-Nov-2011 | 1 | Initial release. |
| 01-Mar-2012 | 2 | Section 8: Package information has been updated. |
| 15-Oct-2012 | 3 | In Section 5.6 changed temperature value from 130 to $120^{\circ} \mathrm{C}$. |
| 19-Mar-2014 | 4 | Updated text below Equation 4 on page 13 and in Equation 5 on page 13 (replaced "DRC" by "DCR"). <br> Updated Figure 34: Positive buck-boost regulator on page 34 (replaced by new figure). <br> Updated Section 8: Package information on page 38 (reversed order of Figure 38 and Table 10, and Figure 9 and Table 11, minor modifications). <br> Updated cross-references throughout document. <br> Minor modifications throughout document. |
| 05-May-2014 | 5 | Updated Table 12: Order code on page 43 (removed the L7986 order code related to the VFDFPN10 in tube, added the L7986ATR order code). |
| 05-Sep-2014 | 6 | Updated Figure 1: Application circuit on page 1 (replaced by new figure). <br> Updated Section 5.1 on page 9 (added "typically" between "frequency" and "works", added "The SYNCH circuitry is also able to synchronize with a slightly lower external frequency, so the frequency pre-adjustment with the same resistor on the FSW pin, as described below, is suggested for a proper operation."). <br> Minor modifications throughout document. |
| 02-Oct-2018 | 7 | Updated Section 8.1: VFDFPN10 (3x3x1.0 mm) package information. |
| 13-Oct-2021 | 8 | Added A Min. and A2 Max. value in Table 11. |# IMPORTANT NOTICE - PLEASE READ CAREFULLY 

STMicroelectronics NV and its subsidiaries ("ST") reserve the right to make changes, corrections, enhancements, modifications, and improvements to ST products and/or to this document at any time without notice. Purchasers should obtain the latest relevant information on ST products before placing orders. ST products are sold pursuant to ST's terms and conditions of sale in place at the time of order acknowledgement.

Purchasers are solely responsible for the choice, selection, and use of ST products and ST assumes no liability for application assistance or the design of Purchasers' products.

No license, express or implied, to any intellectual property right is granted by ST herein.

Resale of ST products with provisions different from the information set forth herein shall void any warranty granted by ST for such product.

ST and the ST logo are trademarks of ST. For additional information about ST trademarks, please refer to www.st.com/trademarks. All other product or service names are the property of their respective owners.

Information in this document supersedes and replaces information previously supplied in any prior versions of this document.
(c) 2021 STMicroelectronics - All rights reserved